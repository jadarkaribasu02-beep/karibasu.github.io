<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Karibasu Blog</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #f4f6f8;
}

header {
  background: #121212;
  color: white;
  padding: 20px;
  text-align: center;
  font-size: 28px;
  letter-spacing: 2px;
}

#adminPanel {
  display: none;
  padding: 20px;
  background: white;
  margin: 20px;
  border-radius: 8px;
}

input, textarea, button {
  width: 100%;
  padding: 10px;
  margin: 8px 0;
  font-size: 16px;
}

button {
  background: black;
  color: white;
  border: none;
  cursor: pointer;
}

button:hover {
  opacity: 0.8;
}

#blogs {
  padding: 20px;
}

.blog-card {
  background: white;
  padding: 15px;
  margin-bottom: 15px;
  border-radius: 8px;
}

.blog-card h3 {
  margin-top: 0;
}
</style>
</head>

<body>

<header>
  Karibasu
</header>

<!-- LOGIN -->
<div id="loginModal" style="padding:20px">
  <input type="password" id="password" placeholder="Admin password">
  <button onclick="login()">Login</button>
</div>

<!-- ADMIN PANEL -->
<div id="adminPanel">
  <h2>Add New Blog</h2>
  <input type="text" id="title" placeholder="Blog Title">
  <textarea id="content" rows="5" placeholder="Blog Content"></textarea>
  <button onclick="addBlog()">Publish</button>
</div>

<!-- BLOG POSTS -->
<div id="blogs"></div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-app.js";
  import { getFirestore, collection, addDoc, getDocs, serverTimestamp } 
  from "https://www.gstatic.com/firebasejs/12.8.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyCHpgQ8xhy8191riHGHHV9Q-lSLnS1opwg",
    authDomain: "karibasu-blog.firebaseapp.com",
    projectId: "karibasu-blog",
    storageBucket: "karibasu-blog.firebasestorage.app",
    messagingSenderId: "1042679795290",
    appId: "1:1042679795290:web:aac92fe10696ac7cee9263"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  const ADMIN_PASSWORD = "karibasu123";

  window.login = function () {
    const pass = document.getElementById("password").value;
    if (pass === ADMIN_PASSWORD) {
      document.getElementById("loginModal").style.display = "none";
      document.getElementById("adminPanel").style.display = "block";
    } else {
      alert("Wrong password");
    }
  };

  window.addBlog = async function () {
    const title = document.getElementById("title").value;
    const content = document.getElementById("content").value;

    if (!title || !content) {
      alert("Fill all fields");
      return;
    }

    await addDoc(collection(db, "blogs"), {
      title,
      content,
      time: serverTimestamp()
    });

    document.getElementById("title").value = "";
    document.getElementById("content").value = "";

    loadBlogs();
  };

  async function loadBlogs() {
    const snapshot = await getDocs(collection(db, "blogs"));
    const blogDiv = document.getElementById("blogs");
    blogDiv.innerHTML = "";

    snapshot.forEach(doc => {
      const blog = doc.data();
      blogDiv.innerHTML += `
        <div class="blog-card">
          <h3>${blog.title}</h3>
          <p>${blog.content}</p>
        </div>
      `;
    });
  }

  loadBlogs();
</script>

</body>
</html>
